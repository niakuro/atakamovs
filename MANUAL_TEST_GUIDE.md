# 手動テストガイド - 観測君VS ULTIMATE Ver 4.1

## テスト実施日: 2026-01-14

---

## 自動テスト結果 ✅

**すべての自動テストが成功しました！**
- バックエンド通信テスト: 17/17 合格
- ゲームメカニクステスト: 9/9 合格
- バグ発見: 1件（修正済み）

---

## 見つかったバグと修正

### バグ#1: 待機画面のCSS問題 ✅ 修正済み
- **場所**: `templates/ultimate.html` 328行目
- **問題**: `display` プロパティが重複していた
- **影響**: 待機画面が本来隠れるべき時に表示されていた
- **修正**: 重複を削除して正常動作を確認

---

## 手動テストチェックリスト

### 1. CPU戦モード 🤖

#### テスト手順:
1. アプリケーションを起動: `python3 app.py`
2. ブラウザで http://localhost:5000 を開く
3. 「CPU戦（練習モード）」ボタンをクリック

#### 確認項目:
- [ ] デッキ編成画面が表示される
- [ ] プリセットデッキが選択できる（社員育成/測量機械/重機土木）
- [ ] カードを追加/削除できる
- [ ] デッキ枚数が40枚になったら「現場へ出撃」が押せる
- [ ] バトル画面に遷移する
- [ ] 自分のターンと相手のターンが交互に来る
- [ ] CPUが自動的にカードをプレイする
- [ ] ターンごとに天候が表示される（晴天/豪雨/濃霧）
- [ ] APが正しく増減する
- [ ] カードをクリックしてプレイできる
- [ ] 場に出したカードのパワーがスコアに加算される
- [ ] ターン終了ボタンが機能する
- [ ] ログに操作履歴が表示される

#### 期待される動作:
- CPUは1.5秒間隔で自動的にカードをプレイする
- CPUはAPがある限りコストの低い順にカードを出す
- CPUの勝利条件達成時に自動的に勝利カードを使用する

---

### 2. オンライン対戦（ルーム機能） 🌐

#### テスト手順:
1. 2つのブラウザウィンドウまたはタブを開く
2. 両方で http://localhost:5000 にアクセス

#### プレイヤー1（ルーム作成者）:
- [ ] 「ルームを作成」ボタンをクリック
- [ ] 待機画面が表示される
- [ ] 4桁のルーム番号が表示される
- [ ] ルーム番号をメモする

#### プレイヤー2（参加者）:
- [ ] 4桁のルーム番号を入力
- [ ] 「参加」ボタンをクリック
- [ ] デッキ編成画面に遷移する

#### 両プレイヤー:
- [ ] 同時にデッキ編成画面が表示される
- [ ] それぞれデッキを選択（または作成）
- [ ] 「現場へ出撃」をクリック
- [ ] バトル画面に遷移
- [ ] ルーム番号がバトル画面に表示される
- [ ] 先攻・後攻がランダムに決定される
- [ ] 相手のフィールドが見える
- [ ] ターン制でプレイできる
- [ ] 両方の画面が同期する

---

### 3. ゲームメカニクス 🎮

#### カードシステム:
- [ ] MACHINE（機材）カードが場に出る
- [ ] SPELL（呪文）カードが即座に発動する
- [ ] GOAL（勝利）カードで勝利できる
- [ ] コストに応じてAPが減少する
- [ ] 手札が5枚から始まる

#### 進化システム:
- [ ] 普通のレベル → オートレベル（コスト1で進化）
- [ ] アルミスタッフ → 反射スタッフ（コスト1で進化）
- [ ] 新入社員 → 担当社員 → 主任技術者（進化チェーン）

#### 天候システム:
- [ ] **晴天**: 通常動作、GNSS衛星のパワー+5
- [ ] **豪雨**: SPELLカード使用不可、生コン車-5（ポンプで無効化可能）
- [ ] **濃霧**: ドローン以外のパワー半減

#### 維持費システム:
- [ ] 場のカードの維持費が自動計算される
- [ ] 事務員がいるとAP+1ボーナス
- [ ] 維持費が払えない場合、カード選択画面が出る

#### 特殊効果:
- [ ] **新入社員**: 登場時1枚ドロー
- [ ] **少数精鋭**: 最大AP-1して2枚ドロー
- [ ] **資金調達**: 永久に最大AP+1
- [ ] **突貫工事**: AP+4だがターン終了時に1台破壊
- [ ] **紛失事故**: 相手のパワー10以上を1台破壊
- [ ] **境界未確定**: 相手の機材を2ターン停止（凍結）

#### スコアと勝利:
- [ ] フィールドのカードパワー合計がスコアになる
- [ ] **Goal30**: スコア30以上で勝利
- [ ] **GoalFinal**: スコア10以上で勝利（コスト10）
- [ ] 勝利時にリザルト画面表示

---

### 4. エラーハンドリング ⚠️

#### テスト項目:
- [ ] 存在しないルーム番号を入力 → エラーメッセージ表示
- [ ] 満員のルーム（2人）に参加 → エラーメッセージ表示
- [ ] 40枚未満のデッキで出撃 → 警告表示
- [ ] APが足りないカードをプレイ → プレイできない
- [ ] 豪雨中にSPELLをプレイ → 「スペル使用不可！」

---

### 5. UI/UX確認 🎨

#### ビジュアル:
- [ ] 背景画像が表示される（工事現場風）
- [ ] カードが美しく表示される（グラデーション、影、ホバー効果）
- [ ] ターン演出（オーバーレイ表示）
- [ ] 勝利/敗北画面
- [ ] カードタイプごとの色分け（MACHINE青/SPELL赤/GOAL金）

#### インタラクション:
- [ ] カードホバー時に浮き上がる
- [ ] クリック時のフィードバック
- [ ] 選択モード時のカード強調表示
- [ ] デッキに追加したカードの光るエフェクト

---

## パフォーマンス確認 ⚡

- [ ] ルーム作成が1秒以内
- [ ] ルーム参加が1秒以内
- [ ] カードプレイが即座に反映
- [ ] ターン切り替えがスムーズ
- [ ] CPU思考時間が適切（1-2秒）

---

## 既知の制限事項 ℹ️

1. **Socket.IO CDN**: 一部の環境でCDNがブロックされる可能性
   - 解決策: Socket.IOをローカルに配置
   
2. **ブラウザの互換性**: Chrome/Firefox/Edgeで動作確認済み

---

## テスト完了チェック ✅

すべての項目を確認したら:
- [ ] CPU戦で最低3回プレイ
- [ ] オンライン対戦で最低2回プレイ
- [ ] 各プリセットデッキを試す
- [ ] 少なくとも1回勝利条件で勝つ
- [ ] バグや問題点をリスト化

---

## バグ報告テンプレート 🐛

もしバグを見つけた場合:

```
### バグ内容
[バグの簡潔な説明]

### 再現手順
1. [手順1]
2. [手順2]
3. [手順3]

### 期待される動作
[どうなるべきか]

### 実際の動作
[何が起きたか]

### スクリーンショット
[可能であれば画像を添付]
```

---

## 結論 🎉

**自動テストはすべて合格しています！**

残りの確認事項:
- CPU AIの挙動
- 完全なゲームプレイフロー
- カード効果の相互作用
- 勝利条件のシナリオ

**ステータス: ユーザー受け入れテスト準備完了** ✨
